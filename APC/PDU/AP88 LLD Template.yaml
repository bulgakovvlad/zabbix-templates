zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: 7df96b18c230490a9a0a9e2307226338
      name: Templates
  templates:
    - uuid: d709f094aac743918948245938aaa1d4
      template: 'APC PDU LLD'
      name: 'APC PDU LLD'
      groups:
        - name: Templates
      items:
        - uuid: e27ed29ea52740de9e6c8105b9960184
          name: 'Power Near Overload Threshold'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.318.1.1.26.4.1.1.8.1
          key: rPDU2DeviceConfigNearOverloadPowerThreshold.1
          delay: 12h
          history: 30d
          value_type: FLOAT
          units: kW
          description: |
            User-defined near power overload threshold,
            measured in tenths of kilowatts. Models that do
            not support this feature will respond to this OID
            with a value of -1.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.1'
          tags:
            - tag: Application
              value: Thresholds
        - uuid: 4777e87a735c41979a75b9df8f201ee7
          name: 'Power Overload Threshold'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.318.1.1.26.4.1.1.9.1
          key: rPDU2DeviceConfigOverloadPowerThreshold.1
          delay: 12h
          history: 30d
          value_type: FLOAT
          units: kW
          description: |
            User-defined near power overload threshold,
            measured in tenths of kilowatts. Models that do
            not support this feature will respond to this OID
            with a value of -1.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.1'
          tags:
            - tag: Application
              value: Thresholds
        - uuid: 5000ae7de9c748199c6b466bf62d394c
          name: 'Max Phase Current Rating'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.318.1.1.26.4.2.1.12.1
          key: rPDU2DevicePropertiesMaxPhaseCurrentRating.1
          delay: 1h
          history: 30d
          units: A
          description: |
            The maximum current rating, measured in Amps, for
            the Rack PDU
          tags:
            - tag: Application
              value: Peaks
        - uuid: 7c40d60134294a0699a4ed4ee5c102e5
          name: 'Total Energy'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.318.1.1.26.4.3.1.9.1
          key: rPDU2DeviceStatusEnergy.1
          delay: 1h
          history: 30d
          value_type: FLOAT
          units: Wh
          description: |
            A user re-settable energy meter measuring Rack PDU load
            energy consumption in tenths of kilowatt-hours.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '100'
          tags:
            - tag: Application
              value: Information
        - uuid: 13fc2d3f57644849afda07a9575e23c4
          name: 'Load State'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.318.1.1.26.4.3.1.4.1
          key: rPDU2DeviceStatusLoadState.1
          delay: 10s
          history: 30d
          description: 'Indicates the present load status of the Rack PDU.'
          valuemap:
            name: 'APC Status Load State'
          tags:
            - tag: Application
              value: Information
          triggers:
            - uuid: 44b2ec96ccd14ec1aa16b416a8a9b5aa
              expression: 'last(/APC PDU LLD/rPDU2DeviceStatusLoadState.1)<>2'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'last(/APC PDU LLD/rPDU2DeviceStatusLoadState.1)=2'
              name: 'APC PDU Load State {HOST.NAME}'
              priority: HIGH
              manual_close: 'YES'
        - uuid: 5634cb38932445dab2508960c3c045ce
          name: 'Peak Power'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.318.1.1.26.4.3.1.6.1
          key: rPDU2DeviceStatusPeakPower.1
          delay: 10s
          history: 30d
          value_type: FLOAT
          units: kw
          description: 'The peak power consumption of the Rack PDU load in hundredths of kilowatts.'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: Application
              value: Power
        - uuid: d658d1d0bfd74b32bbe6b8ae1c4b2248
          name: 'Peak Power Timestamp'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.318.1.1.26.4.3.1.7.1
          key: rPDU2DeviceStatusPeakPowerTimestamp.1
          delay: 1h
          history: 30d
          value_type: CHAR
          trends: '0'
          tags:
            - tag: Application
              value: Power
        - uuid: bb41d465ed404dc0a1d1948c7766e71c
          name: 'Power Consumption'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.318.1.1.26.4.3.1.5.1
          key: rPDU2DeviceStatusPower.1
          delay: 10s
          history: 30d
          value_type: FLOAT
          units: kw
          description: |
            The power consumption of the Rack PDU load in hundredths of kilowatts.
            Models that do not support this feature will respond to this OID
            with a value of -1.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: Application
              value: Power
        - uuid: dc57f4a7308a4e33a86c18f075a913e9
          name: 'Power Supply Alarm'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.318.1.1.26.4.3.1.12.1
          key: rPDU2DeviceStatusPowerSupplyAlarm.1
          delay: 10s
          history: 30d
          description: |
            Indicates a power supply alarm is active when value
            equals alarm (2)
          valuemap:
            name: 'APC Device Status Alarm'
          tags:
            - tag: Application
              value: Information
          triggers:
            - uuid: 00004ea0df5446d0acec3dca8735ffd9
              expression: 'last(/APC PDU LLD/rPDU2DeviceStatusPowerSupplyAlarm.1)<>1'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'last(/APC PDU LLD/rPDU2DeviceStatusPowerSupplyAlarm.1)=1'
              name: 'APC PDU Power Alarm {HOST.NAME}'
              priority: HIGH
              manual_close: 'YES'
        - uuid: 9abf4c3e027644d3b695db735035c166
          name: 'Firmware Rev'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.318.1.1.26.2.1.6.1
          key: rPDU2IdentFirmwareRev.1
          delay: 12h
          history: 30d
          value_type: CHAR
          trends: '0'
          tags:
            - tag: Application
              value: Information
        - uuid: cabd14d5eecf4c2f8b1a137030d621ae
          name: Location
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.318.1.1.26.2.1.4.1
          key: rPDU2IdentLocation.1
          delay: 1h
          history: 30d
          value_type: CHAR
          trends: '0'
          tags:
            - tag: Application
              value: Information
        - uuid: 9a32b4448777451bb3bfbb43c77d0033
          name: 'Model Number'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.318.1.1.26.2.1.8.1
          key: rPDU2IdentModelNumber.1
          delay: 12h
          history: 30d
          value_type: CHAR
          trends: '0'
          tags:
            - tag: Application
              value: Information
        - uuid: 23189f3176374a228d486c2d77eb68d0
          name: 'Identification Name'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.318.1.1.26.2.1.3.1
          key: rPDU2IdentName.1
          delay: 1h
          history: 30d
          value_type: CHAR
          trends: '0'
          tags:
            - tag: Application
              value: Information
        - uuid: 630fb4b489a44be390b7bf9c633d14fc
          name: 'Serial Number'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.318.1.1.26.2.1.9.1
          key: rPDU2IdentSerialNumber.1
          delay: 12h
          history: 30d
          value_type: CHAR
          trends: '0'
          tags:
            - tag: Application
              value: Information
        - uuid: f82cebb087894942a9e9e306c70c7b16
          name: 'Phase Status Peak Current Timestamp'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.318.1.1.26.6.3.1.11.1
          key: rPDU2PhaseStatusPeakCurrentTimestamp.1
          delay: 1h
          history: 30d
          value_type: CHAR
          trends: '0'
          status: DISABLED
          tags:
            - tag: Application
              value: Peaks
        - uuid: 2e51eda8e28f4777b7aed78e667608ae
          name: 'System Up Time'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.3.0
          key: sysUpTime.0
          delay: 1h
          history: 30d
          value_type: FLOAT
          units: uptime
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: Application
              value: Information
        - uuid: 1c414128a481478baaba1ac19750da7e
          name: 'SNMP agent availability'
          type: INTERNAL
          key: 'zabbix[host,snmp,available]'
          valuemap:
            name: zabbix.host.available
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
          tags:
            - tag: Application
              value: Information
      discovery_rules:
        - uuid: ddf946ec19ce49a99b491b47bee087c2
          name: Phases
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.318.1.1.26.6.3.1.6]'
          key: rPDU2Phases
          delay: 1h
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'Scanning PDU phases'
          item_prototypes:
            - uuid: 54e5fc5798dc4bb59adf48250cc3a5a4
              name: 'Phase {#SNMPINDEX} Load'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.318.1.1.12.2.3.1.1.2.{#SNMPINDEX}'
              key: 'rPDU2PhaseLoad[{#SNMPINDEX}]'
              delay: 10s
              value_type: FLOAT
              units: A
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.1'
              tags:
                - tag: Application
                  value: Phases
            - uuid: 6607b67b8a8a4298960f6accdfa627c4
              name: 'Phase {#SNMPINDEX} Low Load Threshold'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.318.1.1.12.2.2.1.1.2.{#SNMPINDEX}'
              key: 'rPDU2PhaseLowLoadThreshold[{#SNMPINDEX}]'
              delay: 12h
              units: A
              tags:
                - tag: Application
                  value: Thresholds
            - uuid: 78dc554af8a94213ba7fb21807465f94
              name: 'Phase {#SNMPINDEX} Near Overload Threshold'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.318.1.1.12.2.2.1.1.3.{#SNMPINDEX}'
              key: 'rPDU2PhaseNearOverloadThreshold[{#SNMPINDEX}]'
              delay: 12h
              units: A
              tags:
                - tag: Application
                  value: Phases
            - uuid: 2851c06241104b4588dcec4b47f33db1
              name: 'Phase {#SNMPINDEX} Overload Threshold'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.318.1.1.12.2.2.1.1.4.{#SNMPINDEX}'
              key: 'rPDU2PhaseOverloadThreshold[{#SNMPINDEX}]'
              delay: 12h
              units: A
              tags:
                - tag: Application
                  value: Thresholds
            - uuid: 709a34dc282a4051b3b017d1013829e6
              name: 'Phase {#SNMPINDEX} Peak Current Timestamp'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.318.1.1.26.6.3.1.11.{#SNMPINDEX}'
              key: 'rPDU2PhasePeakCurrentTimestamp[{#SNMPINDEX}]'
              delay: 1h
              value_type: CHAR
              trends: '0'
              tags:
                - tag: Application
                  value: Peaks
            - uuid: 9c54f7fed6604bc8b3c243cbf159b3b0
              name: 'Phase {#SNMPINDEX} Peak Current'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.318.1.1.26.6.3.1.10.{#SNMPINDEX}'
              key: 'rPDU2PhasePeakCurrent[{#SNMPINDEX}]'
              delay: 6h
              value_type: FLOAT
              units: A
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.1'
              tags:
                - tag: Application
                  value: Peaks
            - uuid: 68a960ba7ddd4fc88e78292288d5b5a8
              name: 'Phase {#SNMPINDEX} Power'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.318.1.1.26.6.3.1.7.{#SNMPINDEX}'
              key: 'rPDU2PhasePower[{#SNMPINDEX}]'
              delay: 10s
              value_type: FLOAT
              units: kW
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                - tag: Application
                  value: Power
            - uuid: 2a4ec132028f4427928344b10142b0e7
              name: 'Phase {#SNMPINDEX} Voltage'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.318.1.1.26.6.3.1.6.{#SNMPINDEX}'
              key: 'rPDU2PhaseVoltage[{#SNMPINDEX}]'
              delay: 10s
              units: V
              tags:
                - tag: Application
                  value: Phases
              trigger_prototypes:
                - uuid: 20e1890c440949769b14b8b7aeb07219
                  expression: 'avg(/APC PDU LLD/rPDU2PhaseVoltage[{#SNMPINDEX}],3m)>=253'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/APC PDU LLD/rPDU2PhaseVoltage[{#SNMPINDEX}],1m)<253'
                  name: 'APC PDU Phase 1 Voltage High {HOST.NAME}'
                  priority: WARNING
                  description: 'If the Phase voltage rises above 253V for an avg of 3 minutes'
                  manual_close: 'YES'
                - uuid: 8cfbb1acf0c146e0a86b1bf7137fa6ae
                  expression: 'avg(/APC PDU LLD/rPDU2PhaseVoltage[{#SNMPINDEX}],3m)<=207'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/APC PDU LLD/rPDU2PhaseVoltage[{#SNMPINDEX}],1m)>207'
                  name: 'APC PDU Phase 1 Voltage Low {HOST.NAME}'
                  priority: WARNING
                  description: 'If the Phase voltage falls below 207V for an avg of 3 minutes'
                  manual_close: 'YES'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#PHASE_LOAD}'
                - 1.3.6.1.4.1.318.1.1.12.2.3.1.1.2
                - '0'
                - '{#PHASE_LOW_THRES}'
                - 1.3.6.1.4.1.318.1.1.12.2.2.1.1.2
                - '0'
                - '{#PHASE_NEAR_OVERLOAD}'
                - 1.3.6.1.4.1.318.1.1.12.2.2.1.1.3
                - '0'
                - '{#PHASE_OVERLOAD}'
                - 1.3.6.1.4.1.318.1.1.12.2.2.1.1.4
                - '0'
                - '{#PHASE_PEAK}'
                - 1.3.6.1.4.1.318.1.1.26.6.3.1.10
                - '0'
                - '{#PHASE_POWER}'
                - 1.3.6.1.4.1.318.1.1.26.6.3.1.7
                - '0'
                - '{#PHASE_VOLTAGE}'
                - 1.3.6.1.4.1.318.1.1.26.6.3.1.6
                - '0'
      tags:
        - tag: class
          value: PDU
        - tag: target
          value: APC
      valuemaps:
        - uuid: 8cde945b13624fcbb3c666b039e93536
          name: 'APC Device Status Alarm'
          mappings:
            - value: '1'
              newvalue: normal
            - value: '2'
              newvalue: alarm
        - uuid: 3c56a802eb794c7c81dd4544fc141531
          name: 'APC Status Load State'
          mappings:
            - value: '1'
              newvalue: lowLoad
            - value: '2'
              newvalue: normal
            - value: '3'
              newvalue: nearOverload
            - value: '4'
              newvalue: overload
        - uuid: f1839d2ce4fd42fdb5af82ec8b91df19
          name: zabbix.host.available
          mappings:
            - value: '0'
              newvalue: 'not available'
            - value: '1'
              newvalue: available
            - value: '2'
              newvalue: unknown
  triggers:
    - uuid: 472cf4219f4040bbb0f5fe8044fce044
      expression: 'last(/APC PDU LLD/rPDU2DeviceStatusPower.1)>=last(/APC PDU LLD/rPDU2DeviceConfigNearOverloadPowerThreshold.1)'
      recovery_mode: RECOVERY_EXPRESSION
      recovery_expression: 'last(/APC PDU LLD/rPDU2DeviceStatusPower.1)<last(/APC PDU LLD/rPDU2DeviceConfigNearOverloadPowerThreshold.1)'
      name: 'APC PDU {HOST.NAME} Power Near Overload'
      priority: HIGH
      description: 'When Power is near overload. Set to the value predetermined by the device presets'
      manual_close: 'YES'
    - uuid: 0b78112bcfca4b8ca42ac0c969149801
      expression: 'last(/APC PDU LLD/rPDU2DeviceStatusPower.1)>=last(/APC PDU LLD/rPDU2DeviceConfigOverloadPowerThreshold.1)'
      recovery_mode: RECOVERY_EXPRESSION
      recovery_expression: 'last(/APC PDU LLD/rPDU2DeviceStatusPower.1)<last(/APC PDU LLD/rPDU2DeviceConfigOverloadPowerThreshold.1)'
      name: 'APC PDU {HOST.NAME} Power Overload'
      priority: DISASTER
      description: 'When Power is at overload. Set to the value predetermined by the device presets'
      manual_close: 'YES'
  graphs:
    - uuid: 0068ac983a8c4e28bf04e0d33e43b980
      name: 'APC Current Usage'
      graph_items:
        - color: 1A7C11
          item:
            host: 'APC PDU LLD'
            key: rPDU2DeviceStatusEnergy.1
    - uuid: 3517ff451d444678bbcc04bc4d4452d0
      name: 'APC Phase Power Status'
      graph_items:
        - sortorder: '1'
          drawtype: DASHED_LINE
          color: DD0000
          item:
            host: 'APC PDU LLD'
            key: rPDU2DevicePropertiesMaxPhaseCurrentRating.1
